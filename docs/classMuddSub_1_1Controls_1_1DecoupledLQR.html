<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MuddSub Software: MuddSub::Controls::DecoupledLQR Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MuddSub Software
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>MuddSub</b></li><li class="navelem"><a class="el" href="namespaceMuddSub_1_1Controls.html">Controls</a></li><li class="navelem"><a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html">DecoupledLQR</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="classMuddSub_1_1Controls_1_1DecoupledLQR-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">MuddSub::Controls::DecoupledLQR Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>a 12DOF optimal controller, using LQR and PID. This decoupled controller implements 8DOF LQR control, handling position and velocity in surge, sway, heave, and yaw. This is what is needed for path following and primary navigation.  
 <a href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="DecoupledLQR_8hh_source.html">DecoupledLQR.hh</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for MuddSub::Controls::DecoupledLQR:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classMuddSub_1_1Controls_1_1DecoupledLQR.png" alt=""/>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a7063007cf0ce8c11a1926918f24e745a"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a7063007cf0ce8c11a1926918f24e745a">stateVector_t</a> = ct::core::StateVector&lt; <a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a44c99a4a628c2e7203a4bf03b6db8f7d">stateDim</a>, double &gt;</td></tr>
<tr class="separator:a7063007cf0ce8c11a1926918f24e745a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f452e3fb9cf07b61670ee10ab9f1cde"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a3f452e3fb9cf07b61670ee10ab9f1cde">controlVector_t</a> = ct::core::ControlVector&lt; <a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a937b04023e940179dfff94b235cc80b1">controlDim</a>, double &gt;</td></tr>
<tr class="separator:a3f452e3fb9cf07b61670ee10ab9f1cde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae806f24deec83625ae1e9afd6b0c19e2"><td class="memItemLeft" align="right" valign="top"><a id="ae806f24deec83625ae1e9afd6b0c19e2"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#ae806f24deec83625ae1e9afd6b0c19e2">ctTime_t</a> = ct::core::ControlledSystem&lt; <a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a44c99a4a628c2e7203a4bf03b6db8f7d">stateDim</a>, <a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a937b04023e940179dfff94b235cc80b1">controlDim</a>, double &gt;::time_t</td></tr>
<tr class="memdesc:ae806f24deec83625ae1e9afd6b0c19e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">The control toolbox has their own time type, which we use for properness. <br /></td></tr>
<tr class="separator:ae806f24deec83625ae1e9afd6b0c19e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a693190022323ba2313a52d329de960b8"><td class="memItemLeft" align="right" valign="top"><a id="a693190022323ba2313a52d329de960b8"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>DecoupledLQR</b> (const <a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html">DecoupledLQR</a> &amp;)=default</td></tr>
<tr class="separator:a693190022323ba2313a52d329de960b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cf7b20cf4ea60174a7bdb2b3cb5a9d6"><td class="memItemLeft" align="right" valign="top"><a id="a0cf7b20cf4ea60174a7bdb2b3cb5a9d6"></a>
<a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html">DecoupledLQR</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a0cf7b20cf4ea60174a7bdb2b3cb5a9d6">clone</a> () const</td></tr>
<tr class="memdesc:a0cf7b20cf4ea60174a7bdb2b3cb5a9d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clone the object. <br /></td></tr>
<tr class="separator:a0cf7b20cf4ea60174a7bdb2b3cb5a9d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93c6617e63a1c2c1da331279d118f452"><td class="memItemLeft" align="right" valign="top"><a id="a93c6617e63a1c2c1da331279d118f452"></a>
<a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a7063007cf0ce8c11a1926918f24e745a">stateVector_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a93c6617e63a1c2c1da331279d118f452">computeError</a> (const <a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a7063007cf0ce8c11a1926918f24e745a">stateVector_t</a> &amp;state, const <a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a7063007cf0ce8c11a1926918f24e745a">stateVector_t</a> &amp;setpoint) const</td></tr>
<tr class="memdesc:a93c6617e63a1c2c1da331279d118f452"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given the state and setpoint, compute the error. <br /></td></tr>
<tr class="separator:a93c6617e63a1c2c1da331279d118f452"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e61f04df141be1d39155e893244730a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a4e61f04df141be1d39155e893244730a">computeControl</a> (const <a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a7063007cf0ce8c11a1926918f24e745a">stateVector_t</a> &amp;state, const double &amp;, <a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a3f452e3fb9cf07b61670ee10ab9f1cde">controlVector_t</a> &amp;controlAction)</td></tr>
<tr class="separator:a4e61f04df141be1d39155e893244730a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21c896126258db1e696539df7bd02a9b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a21c896126258db1e696539df7bd02a9b">setSetpoint</a> (const <a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a7063007cf0ce8c11a1926918f24e745a">stateVector_t</a> &amp;setpoint)</td></tr>
<tr class="separator:a21c896126258db1e696539df7bd02a9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a660773304b1a2ba3f065afb0a5e4ef49"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a660773304b1a2ba3f065afb0a5e4ef49">setDynamics</a> (std::shared_ptr&lt; <a class="el" href="classMuddSub_1_1Controls_1_1VehicleDynamics.html">VehicleDynamics</a> &gt; dynamicsPtr)</td></tr>
<tr class="separator:a660773304b1a2ba3f065afb0a5e4ef49"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a44c99a4a628c2e7203a4bf03b6db8f7d"><td class="memItemLeft" align="right" valign="top"><a id="a44c99a4a628c2e7203a4bf03b6db8f7d"></a>
constexpr static unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a44c99a4a628c2e7203a4bf03b6db8f7d">stateDim</a> = 12</td></tr>
<tr class="memdesc:a44c99a4a628c2e7203a4bf03b6db8f7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dimension of AUV state: [x,y,z,roll,pitch,yaw,x',y',z',roll',pitch',yaw']. <br /></td></tr>
<tr class="separator:a44c99a4a628c2e7203a4bf03b6db8f7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a937b04023e940179dfff94b235cc80b1"><td class="memItemLeft" align="right" valign="top"><a id="a937b04023e940179dfff94b235cc80b1"></a>
constexpr static unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a937b04023e940179dfff94b235cc80b1">controlDim</a> = 6</td></tr>
<tr class="memdesc:a937b04023e940179dfff94b235cc80b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dimension of control: 6DOF wrench. <br /></td></tr>
<tr class="separator:a937b04023e940179dfff94b235cc80b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a589a1f6d066a3e791fa2144a459f7721"><td class="memItemLeft" align="right" valign="top"><a id="a589a1f6d066a3e791fa2144a459f7721"></a>
static constexpr unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a589a1f6d066a3e791fa2144a459f7721">stateDimLQR</a> = 8</td></tr>
<tr class="memdesc:a589a1f6d066a3e791fa2144a459f7721"><td class="mdescLeft">&#160;</td><td class="mdescRight">LQR has state [x,y,z,yaw, x', y', z', yaw']. <br /></td></tr>
<tr class="separator:a589a1f6d066a3e791fa2144a459f7721"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54c8eb5e2cc1c0196cc37613bc1c4ede"><td class="memItemLeft" align="right" valign="top"><a id="a54c8eb5e2cc1c0196cc37613bc1c4ede"></a>
static constexpr unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a54c8eb5e2cc1c0196cc37613bc1c4ede">controlDimLQR</a> = 4</td></tr>
<tr class="memdesc:a54c8eb5e2cc1c0196cc37613bc1c4ede"><td class="mdescLeft">&#160;</td><td class="mdescRight">LQR control is 4DOF wrench: [x,y,z,yaw]. <br /></td></tr>
<tr class="separator:a54c8eb5e2cc1c0196cc37613bc1c4ede"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>a 12DOF optimal controller, using LQR and PID. This decoupled controller implements 8DOF LQR control, handling position and velocity in surge, sway, heave, and yaw. This is what is needed for path following and primary navigation. </p>
<p>Roll and pitch is handled with simple PID controllers, which are generally inactive as the robot is quite stable in those axes (+1 for good mechanical design making software easier). </p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a3f452e3fb9cf07b61670ee10ab9f1cde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f452e3fb9cf07b61670ee10ab9f1cde">&#9670;&nbsp;</a></span>controlVector_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a3f452e3fb9cf07b61670ee10ab9f1cde">MuddSub::Controls::DecoupledLQR::controlVector_t</a> =  ct::core::ControlVector&lt;<a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a937b04023e940179dfff94b235cc80b1">controlDim</a>, double&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The control vector is a 6-vector, which is just the wrench (forces/torques) in 6DOF </p>

</div>
</div>
<a id="a7063007cf0ce8c11a1926918f24e745a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7063007cf0ce8c11a1926918f24e745a">&#9670;&nbsp;</a></span>stateVector_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a7063007cf0ce8c11a1926918f24e745a">MuddSub::Controls::DecoupledLQR::stateVector_t</a> =  ct::core::StateVector&lt;<a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a44c99a4a628c2e7203a4bf03b6db8f7d">stateDim</a>, double&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The state vector is by default a 12D vector, representing the position and attitude in 6DOF, and all of those velocities. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a4e61f04df141be1d39155e893244730a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e61f04df141be1d39155e893244730a">&#9670;&nbsp;</a></span>computeControl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MuddSub::Controls::DecoupledLQR::computeControl </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a7063007cf0ce8c11a1926918f24e745a">stateVector_t</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a3f452e3fb9cf07b61670ee10ab9f1cde">controlVector_t</a> &amp;&#160;</td>
          <td class="paramname"><em>controlAction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given the current error, find the control action (6DOF wrench.) This implements the described controller. </p>

</div>
</div>
<a id="a660773304b1a2ba3f065afb0a5e4ef49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a660773304b1a2ba3f065afb0a5e4ef49">&#9670;&nbsp;</a></span>setDynamics()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MuddSub::Controls::DecoupledLQR::setDynamics </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classMuddSub_1_1Controls_1_1VehicleDynamics.html">VehicleDynamics</a> &gt;&#160;</td>
          <td class="paramname"><em>dynamicsPtr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The controller needs knowledge of the vehicle dynaics to solve the optimal control problem </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dynamicsPtr</td><td>shared_ptr to instance of vehicle dynamics. Only one such instance should be present at a time. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a21c896126258db1e696539df7bd02a9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21c896126258db1e696539df7bd02a9b">&#9670;&nbsp;</a></span>setSetpoint()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MuddSub::Controls::DecoupledLQR::setSetpoint </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMuddSub_1_1Controls_1_1DecoupledLQR.html#a7063007cf0ce8c11a1926918f24e745a">stateVector_t</a> &amp;&#160;</td>
          <td class="paramname"><em>setpoint</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set the 12DOF vehicle setpoint </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">setpoint</td><td>Desired location of robot </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>controls/include/controls/<a class="el" href="DecoupledLQR_8hh_source.html">DecoupledLQR.hh</a></li>
<li>controls/src/DecoupledLQR.cc</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.18
</small></address>
</body>
</html>
